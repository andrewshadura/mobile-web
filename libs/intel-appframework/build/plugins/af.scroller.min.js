!function(a){function b(a){return e[a].el?!0:(delete e[a],!1)}function c(){if(af.os.android&&!af.os.chrome&&af.os.webkit){var c=!1;a.bind(a.touchLayer,["cancel-enter-edit","exit-edit"],function(){if(c){c=!1;for(var a in e)b(a)&&e[a].androidFormsMode&&e[a].stopFormsMode()}})}g=!0}var d=75,e=[],f=function(b){return b.afScrollerId||(b.afScrollerId=a.uuid()),b.afScrollerId};a.fn.scroller=function(b){for(var c,d,g=0;g<this.length;g++)d=f(this[g]),e[d]?c=e[d]:(b||(b={}),a.feat.nativeTouchScroll||(b.useJsScroll=!0),c=h(this[g],b),e[d]=c);return 1==this.length?c:this};var g=!1,h=function(){function b(b,c){var d=document.createElement("div");
return d.style.position="absolute",d.style.width=b+"px",d.style.height=c+"px",d.style[a.feat.cssPrefix+"BorderRadius"]="2px",d.style.borderRadius="2px",d.style.display="none",d.className="scrollBar",d.style.background="black",d}var f,h,i=a.feat.cssTransformStart,j=a.feat.cssTransformEnd,k=function(b,d){var e;return!g&&a.touchLayer&&a.isObject(a.touchLayer)?c():a.touchLayer&&a.isObject(a.touchLayer)||(a.touchLayer={}),e="string"==typeof b||b instanceof String?document.getElementById(b):b,e?af.os.desktop?new l(e,d):d.useJsScroll?new f(e,d):new h(e,d):(alert("Could not find element for scroller "+b),void 0)
},l=function(b,c){this.el=b,this.afEl=a(this.el);for(var d in c)this[d]=c[d]};return l.prototype={refresh:!1,refreshContent:"Pull to Refresh",refreshHangTimeout:2e3,refreshHeight:60,refreshElement:null,refreshCancelCB:null,refreshRunning:!1,scrollTop:0,scrollLeft:0,preventHideRefresh:!0,verticalScroll:!0,horizontalScroll:!1,refreshTriggered:!1,moved:!1,eventsActive:!1,rememberEventsActive:!1,scrollingLocked:!1,autoEnable:!0,blockFormsFix:!1,loggedPcentY:0,loggedPcentX:0,infinite:!1,infiniteEndCheck:!1,infiniteTriggered:!1,scrollSkip:!1,scrollTopInterval:null,scrollLeftInterval:null,bubbles:!0,lockBounce:!1,_scrollTo:function(a,b){if(b=parseInt(b,10),0===b||isNaN(b))return this.el.scrollTop=Math.abs(a.y),this.el.scrollLeft=Math.abs(a.x),void 0;
var c=10,d=(this.el.scrollTop-a.y)/Math.ceil(b/c),e=(this.el.scrollLeft-a.x)/Math.ceil(b/c),f=this,g=Math.ceil(this.el.scrollTop-a.y)/d,h=Math.ceil(this.el.scrollLeft-a.x)/d,i=0,j=0;f.scrollTopInterval=window.setInterval(function(){f.el.scrollTop-=d,j++,j>=g&&(f.el.scrollTop=a.y,clearInterval(f.scrollTopInterval))},c),f.scrollLeftInterval=window.setInterval(function(){f.el.scrollLeft-=e,i++,i>=h&&(f.el.scrollLeft=a.x,clearInterval(f.scrollLeftInterval))},c)},enable:function(){},disable:function(){},hideScrollbars:function(){},addPullToRefresh:function(){},_scrollToTop:function(a){this._scrollTo({x:0,y:0},a)
},_scrollToBottom:function(a){this._scrollTo({x:0,y:this.el.scrollHeight-this.el.offsetHeight},a)},scrollToBottom:function(a){return this._scrollToBottom(a)},scrollToTop:function(a){return this._scrollToTop(a)},init:function(b,c){this.el=b,this.afEl=a(this.el),this.defaultProperties();for(var d in c)this[d]=c[d];var f=this,g=function(){f.eventsActive&&f.adjustScroll()};this.afEl.bind("destroy",function(){f.disable(!0);var b=f.el.afScrollerId;e[b]&&delete e[b],a.unbind(a.touchLayer,"orientationchange-reshape",g)}),a.bind(a.touchLayer,"orientationchange-reshape",g)},needsFormsFix:function(b){return this.useJsScroll&&this.isEnabled()&&"none"!=this.el.style.display&&a(b).closest(this.afEl).size()>0
},handleEvent:function(a){if(!this.scrollingLocked)switch(a.type){case"touchstart":clearInterval(this.scrollTopInterval),this.preventHideRefresh=!this.refreshRunning,this.moved=!1,this.onTouchStart(a),this.bubbles||a.stopPropagation();break;case"touchmove":this.onTouchMove(a),this.bubbles||a.stopPropagation();break;case"touchend":this.onTouchEnd(a),this.bubbles||a.stopPropagation();break;case"scroll":this.onScroll(a)}},coreAddPullToRefresh:function(b){b&&(this.refreshElement=b);var c;if(null===this.refreshElement){var d=document.getElementById(this.container.id+"_pulldown");c=null!==d?af(d):af("<div id='"+this.container.id+"_pulldown' class='afscroll_refresh' style='border-radius:.6em;border: 1px solid #2A2A2A;background-image: -webkit-gradient(linear,left top,left bottom,color-stop(0,#666666),color-stop(1,#222222));background:#222222;margin:0px;height:60px;position:relative;text-align:center;line-height:60px;color:white;width:100%;'>"+this.refreshContent+"</div>")
}else c=af(this.refreshElement);var e=c.get(0);this.refreshContainer=af('<div style="overflow:hidden;width:100%;height:0;margin:0;padding:0;padding-left:5px;padding-right:5px;display:none;"></div>'),a(this.el).prepend(this.refreshContainer.append(e,"top")),this.refreshContainer=this.refreshContainer[0]},fireRefreshRelease:function(b){if(this.refresh&&b){var c=a.trigger(this,"refresh-release",[b])!==!1;if(this.preventHideRefresh=!1,this.refreshRunning=!0,c){var d=this;this.refreshHangTimeout>0&&(this.refreshCancelCB=setTimeout(function(){d.hideRefresh()},this.refreshHangTimeout))}}},setRefreshContent:function(a){af(this.container).find(".afscroll_refresh").html(a)
},lock:function(){this.scrollingLocked||(this.scrollingLocked=!0,this.rememberEventsActive=this.eventsActive,this.eventsActive&&this.disable())},unlock:function(){this.scrollingLocked&&(this.scrollingLocked=!1,this.rememberEventsActive&&this.enable())},scrollToItem:function(b,c){a.is$(b)||(b=a(b));var d,e,f,g;"bottom"==c?(e=b.offset(),d=e.top-this.afEl.offset().bottom+e.height,d+=4):(g=b.offset().top,d=g-document.body.scrollTop,f=this.afEl.offset().top,document.body.scrollTop<f&&(d-=f),d-=4),this.scrollBy({y:d,x:0},0)},setPaddings:function(b,c){var d=a(this.el),e=numOnly(d.css("paddingTop"));d.css("paddingTop",b+"px").css("paddingBottom",c+"px"),this.scrollBy({y:b-e,x:0})
},divide:function(a,b){return 0!==b?a/b:0},isEnabled:function(){return this.eventsActive},addInfinite:function(){this.infinite=!0},clearInfinite:function(){this.infiniteTriggered=!1,this.scrollSkip=!0}},f=function(c,d){this.init(c,d),this.container=this.el.parentNode,this.container.afScrollerId=c.afScrollerId,this.afEl=a(this.container),"hidden"!=this.container.style.overflow&&(this.container.style.overflow="hidden"),this.addPullToRefresh(null,!0),this.autoEnable&&this.enable(!0);var e;this.verticalScroll&&this.verticalScroll===!0&&this.scrollBars===!0&&(e=b(5,20),e.style.top="0px",this.vScrollCSS&&(e.className=this.vScrollCSS),e.style.display="none",this.container.appendChild(e),this.vscrollBar=e,e=null),this.horizontalScroll&&this.horizontalScroll===!0&&this.scrollBars===!0&&(e=b(20,5),e.style.bottom="0px",this.hScrollCSS&&(e.className=this.hScrollCSS),e.style.display="none",this.container.appendChild(e),this.hscrollBar=e,e=null),this.horizontalScroll&&(this.el.style["float"]="left"),this.el.hasScroller=!0
},h=function(b,c){c.nativeParent&&(b=b.parentNode),this.init(b,c);var d=a(b);if(c.noParent!==!0){var e=d.parent();d.css("height",e.height()).css("width",e.width()),d.insertBefore(d.parent()),e.remove()}this.container=this.el,d.css("-webkit-overflow-scrolling","touch"),c.autoEnable&&this.enable()},h.prototype=new l,f.prototype=new l,h.prototype.defaultProperties=function(){this.refreshContainer=null,this.dY=this.cY=0,this.dX=this.cX=0,this.cancelPropagation=!1,this.loggedPcentY=0,this.loggedPcentX=0;var a=this;this.adjustScrollOverflowProxy_=function(){a.afEl.css("overflow","auto"),a.afEl.parent().css("overflow","hidden")
}},h.prototype.enable=function(a){this.eventsActive||(this.eventsActive=!0,this.el.style.overflow="auto",this.el.parentNode.style.overflow="hidden",a||this.adjustScroll(),this.el.addEventListener("touchstart",this,!1),this.el.addEventListener("scroll",this,!1))},h.prototype.disable=function(a){this.eventsActive&&(this.logPos(this.el.scrollLeft,this.el.scrollTop),a||(this.el.style.overflow="hidden"),this.el.removeEventListener("touchstart",this,!1),this.el.removeEventListener("touchmove",this,!1),this.el.removeEventListener("touchend",this,!1),this.el.removeEventListener("scroll",this,!1),this.eventsActive=!1)
},h.prototype.addPullToRefresh=function(a,b){this.el.removeEventListener("touchstart",this,!1),this.el.addEventListener("touchstart",this,!1),b||(this.refresh=!0),this.refresh&&this.refresh===!0&&(this.coreAddPullToRefresh(a),this.refreshContainer.style.position="absolute",this.refreshContainer.style.top="-60px",this.refreshContainer.style.height="60px",this.refreshContainer.style.display="block")},h.prototype.onTouchStart=function(a){0===this.el.scrollTop&&(this.el.scrollTop=1),this.el.scrollTop===this.el.scrollHeight-this.el.clientHeight&&(this.el.scrollTop-=1),this.horizontalScroll&&(0===this.el.scrollLeft&&(this.el.scrollLeft=1),this.el.scrollLeft===this.el.scrollWidth-this.el.clientWidth&&(this.el.scrollLeft-=1)),this.refreshCancelCB&&clearTimeout(this.refreshCancelCB),this.el.addEventListener("touchmove",this,!1),this.dY=a.touches[0].pageY,(this.refresh||this.infinite)&&this.refresh&&this.dY<0&&this.showRefresh()
},h.prototype.onTouchMove=function(b){var c=b.touches[0].pageY-this.dY,d=b.touches[0].pageX-this.dX;this.hasVertScroll&&this.el.clientHeight==this.el.scrollHeight&&b.preventDefault(),this.hasHorScroll&&this.el.clientWidth==this.el.scrollWidth&&b.preventDefault(),this.moved||(a.trigger(this,"scrollstart",[this.el]),a.trigger(a.touchLayer,"scrollstart",[this.el]),this.el.addEventListener("touchend",this,!1),this.moved=!0),c-this.cY,d-this.cX,this.refresh&&this.el.scrollTop<0?this.showRefresh():this.refreshTriggered&&this.refresh&&this.el.scrollTop>this.refreshHeight&&(this.refreshTriggered=!1,this.refreshCancelCB&&clearTimeout(this.refreshCancelCB),this.hideRefresh(!1),a.trigger(this,"refresh-cancel")),this.cY=c,this.cX=d
},h.prototype.showRefresh=function(){this.refreshTriggered||(this.refreshTriggered=!0,a.trigger(this,"refresh-trigger"))},h.prototype.onTouchEnd=function(){var b=this.el.scrollTop<=-this.refreshHeight;this.fireRefreshRelease(b,!0),b&&this.refresh&&(this.refreshContainer.style.position="relative",this.refreshContainer.style.top="0px"),this.dY=this.cY=0,this.el.removeEventListener("touchmove",this,!1),this.el.removeEventListener("touchend",this,!1),this.infiniteEndCheck=!0,this.infinite&&!this.infiniteTriggered&&Math.abs(this.el.scrollTop)>=this.el.scrollHeight-this.el.clientHeight&&(this.infiniteTriggered=!0,a.trigger(this,"infinite-scroll"),this.infiniteEndCheck=!0),this.touchEndFired=!0;
var c=200,d=this,e={top:this.el.scrollTop,left:this.el.scrollLeft},f=0;d.nativePolling=setInterval(function(){return f++,f>=c?(clearInterval(d.nativePolling),void 0):((d.el.scrollTop!=e.top||d.el.scrollLeft!=e.left)&&(clearInterval(d.nativePolling),a.trigger(a.touchLayer,"scrollend",[d.el]),a.trigger(d,"scrollend",[d.el])),void 0)},20)},h.prototype.hideRefresh=function(b){if(!this.preventHideRefresh){var c=this,e=function(b){b||(c.el.style[a.feat.cssPrefix+"Transform"]="none",c.el.style[a.feat.cssPrefix+"TransitionProperty"]="none",c.el.scrollTop=0,c.logPos(c.el.scrollLeft,0)),c.refreshContainer.style.top="-60px",c.refreshContainer.style.position="absolute",c.dY=c.cY=0,a.trigger(c,"refresh-finish")
};b!==!1&&c.afEl.css3Animate?c.afEl.css3Animate({y:c.el.scrollTop-c.refreshHeight+"px",x:"0%",time:d+"ms",complete:e}):e(),this.refreshTriggered=!1}},h.prototype.hideScrollbars=function(){},h.prototype.scrollTo=function(a,b){return this.logPos(a.x,a.y),a.x*=-1,a.y*=-1,this._scrollTo(a,b)},h.prototype.scrollBy=function(a,b){return a.x+=this.el.scrollLeft,a.y+=this.el.scrollTop,this.logPos(this.el.scrollLeft,this.el.scrollTop),this._scrollTo(a,b)},h.prototype.scrollToBottom=function(a){this._scrollToBottom(a),this.logPos(this.el.scrollLeft,this.el.scrollTop)},h.prototype.onScroll=function(){if(this.infinite&&this.touchEndFired)return this.touchEndFired=!1,void 0;
if(this.scrollSkip)return this.scrollSkip=!1,void 0;this.infinite&&!this.infiniteTriggered&&Math.abs(this.el.scrollTop)>=this.el.scrollHeight-this.el.clientHeight&&(this.infiniteTriggered=!0,a.trigger(this,"infinite-scroll"),this.infiniteEndCheck=!0);var b=this;this.infinite&&this.infiniteEndCheck&&this.infiniteTriggered&&(this.infiniteEndCheck=!1,a.trigger(b,"infinite-scroll-end"))},h.prototype.logPos=function(a,b){this.loggedPcentX=this.divide(a,this.el.scrollWidth),this.loggedPcentY=this.divide(b,this.el.scrollHeight),this.scrollLeft=a,this.scrollTop=b,isNaN(this.loggedPcentX)&&(this.loggedPcentX=0),isNaN(this.loggedPcentY)&&(this.loggedPcentY=0)
},h.prototype.adjustScroll=function(){this.adjustScrollOverflowProxy_(),this.el.scrollLeft=this.loggedPcentX*this.el.scrollWidth,this.el.scrollTop=this.loggedPcentY*this.el.scrollHeight,this.logPos(this.el.scrollLeft,this.el.scrollTop)},f.prototype.defaultProperties=function(){this.boolScrollLock=!1,this.currentScrollingObject=null,this.elementInfo=null,this.verticalScroll=!0,this.horizontalScroll=!1,this.scrollBars=!0,this.vscrollBar=null,this.hscrollBar=null,this.hScrollCSS="scrollBar",this.vScrollCSS="scrollBar",this.firstEventInfo=null,this.moved=!1,this.preventPullToRefresh=!0,this.isScrolling=!1,this.androidFormsMode=!1,this.refreshSafeKeep=!1,this.lastScrollbar="",this.finishScrollingObject=null,this.container=null,this.scrollingFinishCB=null,this.loggedPcentY=0,this.loggedPcentX=0
},f.prototype.enable=function(a){this.eventsActive||(this.eventsActive=!0,a?this.scrollerMoveCSS({x:0,y:0},0):this.adjustScroll(),this.container.addEventListener("touchstart",this,!1),this.container.addEventListener("touchmove",this,!1),this.container.addEventListener("touchend",this,!1))},f.prototype.adjustScroll=function(){var a=this.getViewportSize();this.scrollerMoveCSS({x:Math.round(this.loggedPcentX*(this.el.clientWidth-a.w)),y:Math.round(this.loggedPcentY*(this.el.clientHeight-a.h))},0)},f.prototype.disable=function(){if(this.eventsActive){var a=this.getCSSMatrix(this.el);this.logPos(numOnly(a.e)-numOnly(this.container.scrollLeft),numOnly(a.f)-numOnly(this.container.scrollTop)),this.container.removeEventListener("touchstart",this,!1),this.container.removeEventListener("touchmove",this,!1),this.container.removeEventListener("touchend",this,!1),this.eventsActive=!1
}},f.prototype.addPullToRefresh=function(a,b){b||(this.refresh=!0),this.refresh&&this.refresh===!0&&(this.coreAddPullToRefresh(a),this.el.style.overflow="visible")},f.prototype.hideScrollbars=function(){this.hscrollBar&&(this.hscrollBar.style.display="none",this.hscrollBar.style[a.feat.cssPrefix+"TransitionDuration"]="0ms"),this.vscrollBar&&(this.vscrollBar.style.display="none",this.vscrollBar.style[a.feat.cssPrefix+"TransitionDuration"]="0ms")},f.prototype.getViewportSize=function(){var a=window.getComputedStyle(this.container);return isNaN(numOnly(a.paddingTop))&&alert(typeof a.paddingTop+"::"+a.paddingTop+":"),{h:this.container.clientHeight>window.innerHeight?window.innerHeight:this.container.clientHeight-numOnly(a.paddingTop)-numOnly(a.paddingBottom),w:this.container.clientWidth>window.innerWidth?window.innerWidth:this.container.clientWidth-numOnly(a.paddingLeft)-numOnly(a.paddingRight)}
},f.prototype.onTouchStart=function(b){if(this.moved=!1,this.currentScrollingObject=null,this.container&&(this.refreshCancelCB&&(clearTimeout(this.refreshCancelCB),this.refreshCancelCB=null),this.scrollingFinishCB&&(clearTimeout(this.scrollingFinishCB),this.scrollingFinishCB=null),1==b.touches.length&&!this.boolScrollLock)){if(b.touches[0].target&&void 0!==b.touches[0].target.type){var c=b.touches[0].target.tagName.toLowerCase();if(b.touches[0].target.type.toLowerCase(),"select"==c)return}var d={top:0,left:0,speedY:0,speedX:0,absSpeedY:0,absSpeedX:0,deltaY:0,deltaX:0,absDeltaY:0,absDeltaX:0,y:0,x:0,duration:0};
this.elementInfo={};var e=this.getViewportSize();this.elementInfo.bottomMargin=e.h,this.elementInfo.maxTop=this.el.clientHeight-this.elementInfo.bottomMargin,this.elementInfo.maxTop<0&&(this.elementInfo.maxTop=0),this.elementInfo.divHeight=this.el.clientHeight,this.elementInfo.rightMargin=e.w,this.elementInfo.maxLeft=this.el.clientWidth-this.elementInfo.rightMargin,this.elementInfo.maxLeft<0&&(this.elementInfo.maxLeft=0),this.elementInfo.divWidth=this.el.clientWidth,this.elementInfo.hasVertScroll=this.verticalScroll||this.elementInfo.maxTop>0,this.elementInfo.hasHorScroll=this.elementInfo.maxLeft>0,this.elementInfo.requiresVScrollBar=this.vscrollBar&&this.elementInfo.hasVertScroll,this.elementInfo.requiresHScrollBar=this.hscrollBar&&this.elementInfo.hasHorScroll,this.saveEventInfo(b),this.saveFirstEventInfo(b);
var f=this.getCSSMatrix(this.el);d.top=numOnly(f.f)-numOnly(this.container.scrollTop),d.left=numOnly(f.e)-numOnly(this.container.scrollLeft),this.container.scrollTop=this.container.scrollLeft=0,this.currentScrollingObject=this.el,this.refresh&&0===d.top?(this.refreshContainer.style.display="block",this.refreshHeight=this.refreshContainer.firstChild.clientHeight,this.refreshContainer.firstChild.style.top=-this.refreshHeight+"px",this.refreshContainer.style.overflow="visible",this.preventPullToRefresh=!1):d.top<0&&(this.preventPullToRefresh=!0,this.refresh&&(this.refreshContainer.style.overflow="hidden")),d.x=d.left,d.y=d.top,this.setVScrollBar(d,0,0)&&(this.vscrollBar.style.right=this.container.clientWidth>window.innerWidth?"0px":"0px",this.vscrollBar.style[a.feat.cssPrefix+"Transition"]=""),this.setHScrollBar(d,0,0)&&(this.container.clientHeight>window.innerHeight?this.hscrollBar.style.top=window.innerHeight-numOnly(this.hscrollBar.style.height)+"px":this.hscrollBar.style.bottom=numOnly(this.hscrollBar.style.height),this.hscrollBar.style[a.feat.cssPrefix+"Transition"]=""),this.lastScrollInfo=d,this.hasMoved=!1,this.scrollerMoveCSS(this.lastScrollInfo,0)
}},f.prototype.getCSSMatrix=function(b){if(this.androidFormsMode){var c=parseInt(b.style.marginTop,10),d=parseInt(b.style.marginLeft,10);return isNaN(c)&&(c=0),isNaN(d)&&(d=0),{f:c,e:d}}var e=a.getCssMatrix(b);return e},f.prototype.saveEventInfo=function(a){this.lastEventInfo={pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,time:a.timeStamp}},f.prototype.saveFirstEventInfo=function(a){this.firstEventInfo={pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,time:a.timeStamp}},f.prototype.setVScrollBar=function(a,b,c){if(!this.elementInfo.requiresVScrollBar)return!1;var d=parseFloat(this.elementInfo.bottomMargin/this.elementInfo.divHeight)*this.elementInfo.bottomMargin+"px";
numOnly(d)>this.elementInfo.bottomMargin&&(d=this.elementInfo.bottomMargin+"px"),d!=this.vscrollBar.style.height&&(this.vscrollBar.style.height=d);var e=this.elementInfo.bottomMargin-numOnly(this.vscrollBar.style.height)-(this.elementInfo.maxTop+a.y)/this.elementInfo.maxTop*(this.elementInfo.bottomMargin-numOnly(this.vscrollBar.style.height));return e>this.elementInfo.bottomMargin&&(e=this.elementInfo.bottomMargin),0>e&&(e=0),this.scrollbarMoveCSS(this.vscrollBar,{x:0,y:e},b,c),!0},f.prototype.setHScrollBar=function(a,b,c){if(!this.elementInfo.requiresHScrollBar)return!1;var d=parseFloat(this.elementInfo.rightMargin/this.elementInfo.divWidth)*this.elementInfo.rightMargin+"px";
d!=this.hscrollBar.style.width&&(this.hscrollBar.style.width=d);var e=this.elementInfo.rightMargin-numOnly(this.hscrollBar.style.width)-(this.elementInfo.maxLeft+a.x)/this.elementInfo.maxLeft*(this.elementInfo.rightMargin-numOnly(this.hscrollBar.style.width));return e>this.elementInfo.rightMargin&&(e=this.elementInfo.rightMargin),0>e&&(e=0),this.scrollbarMoveCSS(this.hscrollBar,{x:e,y:0},b,c),!0},f.prototype.onTouchMove=function(b){if(null!==this.currentScrollingObject){var c=this.calculateMovement(b);this.calculateTarget(c),this.lastScrollInfo=c,this.moved||(a.trigger(this,"scrollstart"),a.trigger(a.touchLayer,"scrollstart",[this.el]),this.elementInfo.requiresVScrollBar&&(this.vscrollBar.style.display="block"),this.elementInfo.requiresHScrollBar&&(this.hscrollBar.style.display="block")),this.moved=!0,this.refresh&&0===c.top?(this.refreshContainer.style.display="block",this.refreshHeight=this.refreshContainer.firstChild.clientHeight,this.refreshContainer.firstChild.style.top=-this.refreshHeight+"px",this.refreshContainer.style.overflow="visible",this.preventPullToRefresh=!1):c.top<0&&(this.preventPullToRefresh=!0,this.refresh&&(this.refreshContainer.style.overflow="hidden")),this.saveEventInfo(b),this.isScrolling===!1&&(this.isScrolling=!0,this.onScrollStart&&this.onScrollStart());
var d=this.getCSSMatrix(this.el);this.lastScrollInfo.top=numOnly(d.f),this.lastScrollInfo.left=numOnly(d.e),this.recalculateDeltaY(this.lastScrollInfo),this.recalculateDeltaX(this.lastScrollInfo),this.checkYboundary(this.lastScrollInfo),this.elementInfo.hasHorScroll&&this.checkXboundary(this.lastScrollInfo);var e=this.lastScrollInfo.y>0&&this.lastScrollInfo.deltaY>0,f=this.lastScrollInfo.y<-this.elementInfo.maxTop&&this.lastScrollInfo.deltaY<0;if(e||f){var g=e?this.lastScrollInfo.y:-this.lastScrollInfo.y-this.elementInfo.maxTop,h=(this.container.clientHeight-g)/this.container.clientHeight;.5>h&&(h=.5);
var i=0;e&&this.lastScrollInfo.top>0||f&&this.lastScrollInfo.top<-this.elementInfo.maxTop?i=this.lastScrollInfo.top:f&&(i=-this.elementInfo.maxTop);var j=this.lastScrollInfo.deltaY*h,k=Math.abs(this.lastScrollInfo.deltaY*h);1>k&&(j=e?1:-1),this.lastScrollInfo.y=i+j}if(this.elementInfo.hasHorScroll&&(e=this.lastScrollInfo.x>0&&this.lastScrollInfo.deltaX>0,f=this.lastScrollInfo.x<-this.elementInfo.maxLeft&&this.lastScrollInfo.deltaX<0,e||f)){var g=e?this.lastScrollInfo.x:-this.lastScrollInfo.x-this.elementInfo.maxLeft,h=(this.container.clientWidth-g)/this.container.clientWidth;.5>h&&(h=.5);var i=0;
e&&this.lastScrollInfo.left>0||f&&this.lastScrollInfo.left<-this.elementInfo.maxLeft?i=this.lastScrollInfo.left:f&&(i=-this.elementInfo.maxLeft);var l=this.lastScrollInfo.deltaX*h,m=Math.abs(this.lastScrollInfo.deltaX*h);1>m&&(l=e?1:-1),this.lastScrollInfo.x=i+l}this.lockBounce&&(this.lastScrollInfo.x>0?this.lastScrollInfo.x=0:-1*this.lastScrollInfo.x>this.elementInfo.maxLeft&&(this.lastScrollInfo.x=-1*this.elementInfo.maxLeft),this.lastScrollInfo.y>0?this.lastScrollInfo.y=0:-1*this.lastScrollInfo.y>this.elementInfo.maxTop&&(this.lastScrollInfo.y=-1*this.elementInfo.maxTop)),this.scrollerMoveCSS(this.lastScrollInfo,0),this.setVScrollBar(this.lastScrollInfo,0,0),this.setHScrollBar(this.lastScrollInfo,0,0),this.refresh&&!this.preventPullToRefresh&&(!this.refreshTriggered&&this.lastScrollInfo.top>this.refreshHeight?(this.refreshTriggered=!0,a.trigger(this,"refresh-trigger")):this.refreshTriggered&&this.lastScrollInfo.top<this.refreshHeight&&(this.refreshTriggered=!1,a.trigger(this,"refresh-cancel"))),this.infinite&&!this.infiniteTriggered&&Math.abs(this.lastScrollInfo.top)>=this.el.clientHeight-this.container.clientHeight&&(this.infiniteTriggered=!0,a.trigger(this,"infinite-scroll"))
}},f.prototype.calculateMovement=function(a,b){var c={top:0,left:0,speedY:0,speedX:0,absSpeedY:0,absSpeedX:0,deltaY:0,deltaX:0,absDeltaY:0,absDeltaX:0,y:0,x:0,duration:0},d=b?this.firstEventInfo:this.lastEventInfo,e=b?a.pageX:a.touches[0].pageX,f=b?a.pageY:a.touches[0].pageY,g=b?a.time:a.timeStamp;return c.deltaY=this.elementInfo.hasVertScroll?f-d.pageY:0,c.deltaX=this.elementInfo.hasHorScroll?e-d.pageX:0,c.time=g,c.duration=g-d.time,c},f.prototype.calculateTarget=function(a){a.y=this.lastScrollInfo.y+a.deltaY,a.x=this.lastScrollInfo.x+a.deltaX},f.prototype.checkYboundary=function(a){var b=this.container.clientHeight/2,c=this.elementInfo.maxTop+b;
if(a.y>b)a.y=b;else{if(!(-a.y>c))return;a.y=-c}this.recalculateDeltaY(a)},f.prototype.checkXboundary=function(a){var b=this.container.clientWidth/2,c=this.elementInfo.maxLeft+b;if(a.x>b)a.x=b;else{if(!(-a.x>c))return;a.x=-c}this.recalculateDeltaX(a)},f.prototype.recalculateDeltaY=function(a){var b=Math.abs(a.deltaY);a.deltaY=a.y-a.top,newAbsDeltaY=Math.abs(a.deltaY),a.duration=a.duration*newAbsDeltaY/b},f.prototype.recalculateDeltaX=function(a){var b=Math.abs(a.deltaX);a.deltaX=a.x-a.left,newAbsDeltaX=Math.abs(a.deltaX),a.duration=a.duration*newAbsDeltaX/b},f.prototype.hideRefresh=function(){var b=this;
this.preventHideRefresh||(this.scrollerMoveCSS({x:0,y:0,complete:function(){a.trigger(b,"refresh-finish")}},d),this.refreshTriggered=!1)},f.prototype.setMomentum=function(a){var b=.0012;a.speedY=this.divide(a.deltaY,a.duration),a.speedX=this.divide(a.deltaX,a.duration),a.absSpeedY=Math.abs(a.speedY),a.absSpeedX=Math.abs(a.speedX),a.absDeltaY=Math.abs(a.deltaY),a.absDeltaX=Math.abs(a.deltaX),a.absDeltaY>0?(a.deltaY=(a.deltaY<0?-1:1)*a.absSpeedY*a.absSpeedY/(2*b),a.absDeltaY=Math.abs(a.deltaY),a.duration=a.absSpeedY/b,a.speedY=a.deltaY/a.duration,a.absSpeedY=Math.abs(a.speedY),(a.absSpeedY<100*b||a.absDeltaY<5)&&(a.deltaY=a.absDeltaY=a.duration=a.speedY=a.absSpeedY=0)):a.absDeltaX?(a.deltaX=(a.deltaX<0?-1:1)*a.absSpeedX*a.absSpeedX/(2*b),a.absDeltaX=Math.abs(a.deltaX),a.duration=a.absSpeedX/b,a.speedX=a.deltaX/a.duration,a.absSpeedX=Math.abs(a.speedX),(a.absSpeedX<100*b||a.absDeltaX<5)&&(a.deltaX=a.absDeltaX=a.duration=a.speedX=a.absSpeedX=0)):a.duration=0
},f.prototype.onTouchEnd=function(){if(null!==this.currentScrollingObject&&this.moved){this.finishScrollingObject=this.currentScrollingObject,this.currentScrollingObject=null;var b=this.calculateMovement(this.lastEventInfo,!0);this.androidFormsMode||this.setMomentum(b),this.calculateTarget(b);var c=this.getCSSMatrix(this.el);b.top=numOnly(c.f),b.left=numOnly(c.e),this.checkYboundary(b),this.elementInfo.hasHorScroll&&this.checkXboundary(b);var e=!this.preventPullToRefresh&&(b.top>this.refreshHeight||b.y>this.refreshHeight);this.fireRefreshRelease(e,b.top>0),this.refresh&&e?(b.y=this.refreshHeight,b.duration=d):b.y>=0?(b.y=0,b.top>=0&&(b.duration=d)):(-b.y>this.elementInfo.maxTop||0===this.elementInfo.maxTop)&&(b.y=-this.elementInfo.maxTop,-b.top>this.elementInfo.maxTop&&(b.duration=d)),this.elementInfo.hasHorScroll&&(b.x>=0?(b.x=0,b.left>=0&&(b.duration=d)):(-b.x>this.elementInfo.maxLeft||0===this.elementInfo.maxLeft)&&(b.x=-this.elementInfo.maxLeft,-b.left>this.elementInfo.maxLeft&&(b.duration=d))),this.androidFormsMode&&(b.duration=0),this.scrollerMoveCSS(b,b.duration,"cubic-bezier(0.33,0.66,0.66,1)"),this.setVScrollBar(b,b.duration,"cubic-bezier(0.33,0.66,0.66,1)"),this.setHScrollBar(b,b.duration,"cubic-bezier(0.33,0.66,0.66,1)"),this.setFinishCalback(b.duration),this.infinite&&!this.infiniteTriggered&&Math.abs(b.y)>=this.el.clientHeight-this.container.clientHeight&&(this.infiniteTriggered=!0,a.trigger(this,"infinite-scroll"))
}},f.prototype.setFinishCalback=function(b){var c=this;this.scrollingFinishCB=setTimeout(function(){c.hideScrollbars(),a.trigger(a.touchLayer,"scrollend",[c.el]),a.trigger(c,"scrollend",[c.el]),c.isScrolling=!1,c.elementInfo=null,c.infinite&&a.trigger(c,"infinite-scroll-end")},b)},f.prototype.startFormsMode=function(){if(!this.blockFormsFix){var b=this.getCSSMatrix(this.el);this.refreshSafeKeep=this.refresh,this.refresh=!1,this.androidFormsMode=!0,this.el.style[a.feat.cssPrefix+"Transform"]="none",this.el.style[a.feat.cssPrefix+"Transition"]="none",this.el.style[a.feat.cssPrefix+"Perspective"]="none",this.scrollerMoveCSS({x:numOnly(b.e),y:numOnly(b.f)},0),this.container.style[a.feat.cssPrefix+"Perspective"]="none",this.container.style[a.feat.cssPrefix+"BackfaceVisibility"]="visible",this.vscrollBar&&(this.vscrollBar.style[a.feat.cssPrefix+"Transform"]="none",this.vscrollBar.style[a.feat.cssPrefix+"Transition"]="none",this.vscrollBar.style[a.feat.cssPrefix+"Perspective"]="none",this.vscrollBar.style[a.feat.cssPrefix+"BackfaceVisibility"]="visible"),this.hscrollBar&&(this.hscrollBar.style[a.feat.cssPrefix+"Transform"]="none",this.hscrollBar.style[a.feat.cssPrefix+"Transition"]="none",this.hscrollBar.style[a.feat.cssPrefix+"Perspective"]="none",this.hscrollBar.style[a.feat.cssPrefix+"BackfaceVisibility"]="visible")
}},f.prototype.stopFormsMode=function(){if(!this.blockFormsFix){var b=this.getCSSMatrix(this.el);this.refresh=this.refreshSafeKeep,this.androidFormsMode=!1,this.el.style[a.feat.cssPrefix+"Perspective"]=1e3,this.el.style.marginTop=0,this.el.style.marginLeft=0,this.el.style[a.feat.cssPrefix+"Transition"]="0ms linear",this.scrollerMoveCSS({x:numOnly(b.e),y:numOnly(b.f)},0),this.container.style[a.feat.cssPrefix+"Perspective"]=1e3,this.container.style[a.feat.cssPrefix+"BackfaceVisibility"]="hidden",this.vscrollBar&&(this.vscrollBar.style[a.feat.cssPrefix+"Perspective"]=1e3,this.vscrollBar.style[a.feat.cssPrefix+"BackfaceVisibility"]="hidden"),this.hscrollBar&&(this.hscrollBar.style[a.feat.cssPrefix+"Perspective"]=1e3,this.hscrollBar.style[a.feat.cssPrefix+"BackfaceVisibility"]="hidden")
}},f.prototype.scrollerMoveCSS=function(b,c,d){c||(c=0),d||(d="linear"),c=numOnly(c),this.el&&this.el.style&&(this.eventsActive&&(this.androidFormsMode?(this.el.style.marginTop=Math.round(b.y)+"px",this.el.style.marginLeft=Math.round(b.x)+"px"):(this.el.style[a.feat.cssPrefix+"Transform"]="translate"+i+b.x+"px,"+b.y+"px"+j,this.el.style[a.feat.cssPrefix+"TransitionDuration"]=c+"ms",this.el.style[a.feat.cssPrefix+"TransitionTimingFunction"]=d)),this.logPos(b.x,b.y))},f.prototype.logPos=function(a,b){var c;c=this.elementInfo?{h:this.elementInfo.bottomMargin,w:this.elementInfo.rightMargin}:this.getViewportSize(),this.loggedPcentX=this.divide(a,this.el.clientWidth-c.w),this.loggedPcentY=this.divide(b,this.el.clientHeight-c.h),this.scrollTop=b,this.scrollLeft=a
},f.prototype.scrollbarMoveCSS=function(b,c,d,e){d||(d=0),e||(e="linear"),b&&b.style&&(this.androidFormsMode?(b.style.marginTop=Math.round(c.y)+"px",b.style.marginLeft=Math.round(c.x)+"px"):(b.style[a.feat.cssPrefix+"Transform"]="translate"+i+c.x+"px,"+c.y+"px"+j,b.style[a.feat.cssPrefix+"TransitionDuration"]=d+"ms",b.style[a.feat.cssPrefix+"TransitionTimingFunction"]=e))},f.prototype.scrollTo=function(a,b){b||(b=0),this.scrollerMoveCSS(a,b)},f.prototype.scrollBy=function(a,b){var c=this.getCSSMatrix(this.el),d=numOnly(c.f),e=numOnly(c.e);this.scrollTo({y:d-a.y,x:e-a.x},b)},f.prototype.scrollToBottom=function(a){this.scrollTo({y:-1*(this.el.clientHeight-this.container.clientHeight),x:0},a)
},f.prototype.scrollToTop=function(a){this.scrollTo({x:0,y:0},a)},k}()}(af);